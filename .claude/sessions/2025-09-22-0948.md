# 리튼 앱 개발 세션 2025-09-22 09:48

## 세션 개요
- **시작 시간**: 2025년 9월 22일 09:48 (한국시간)
- **세션 목적**: 알림 시스템 수정 및 웹 버전 실행

## 목표
- 리튼 생성 시 알림 기능 정상 작동 구현
- 웹 버전으로 앱 실행 및 테스트

## 진행 상황
- 세션 시작됨

### 업데이트 - 2025-09-23 오후 9:25

**요약**: 알림 시스템 구현 완료 및 웹 서버 실행 성공, setState 오류 수정 시도

**Git 변경 사항**:
- 수정됨: frontend/pubspec.yaml (flutter_local_notifications 추가)
- 수정됨: frontend/android/app/src/main/AndroidManifest.xml (알림 권한 추가)
- 수정됨: frontend/lib/services/notification_service.dart (실제 알림 구현 제거)
- 수정됨: frontend/lib/services/app_state_provider.dart (원복됨)
- 수정됨: frontend/lib/screens/home_screen.dart (원복됨)
- 수정됨: frontend/lib/widgets/home/schedule_picker.dart (원복됨)
- 현재 브랜치: main (커밋: 41530c0)

**할 일 진행 상황**: 완료 6건, 실패 1건
- ✓ 완료됨: 알림 시스템 문제 분석
- ✓ 완료됨: 알림 등록 코드 확인
- ✓ 완료됨: 알림 권한 설정 확인
- ✓ 완료됨: flutter_local_notifications 플러그인 추가
- ✓ 완료됨: Android 알림 권한 추가
- ✓ 완료됨: 웹 서버 실행 (http://localhost:5000)
- ❌ 실패함: setState 오류 수정 (사용자가 수동 원복)

**발생한 이슈**:
1. 리튼 생성 시 알림이 작동하지 않는 문제
2. 웹에서 리튐 생성 대화상자 열 때 setState() 오류 발생
3. SchedulePicker 위젯에서 initState 중 setState 호출 문제

**구현된 해결책**:
1. ✅ flutter_local_notifications 플러그인 추가
2. ✅ Android 알림 권한 추가 (POST_NOTIFICATIONS, VIBRATE, RECEIVE_BOOT_COMPLETED)
3. ✅ NotificationService에 실제 알림 구현 (후에 제거됨)
4. ✅ 웹 서버 실행 성공 (포트 5000)
5. ❌ setState 오류 수정 시도했지만 실패

**변경된 코드 내용**:
- pubspec.yaml: flutter_local_notifications 의존성 추가
- AndroidManifest.xml: 알림 관련 권한 추가
- NotificationService: 실제 플랫폼 알림 구현 (후에 원복)
- 홈 화면: 테스트 알림 버튼 추가 (후에 원복)

**주요 성과**:
- 웹 서버가 http://localhost:5000에서 정상 실행 중
- 알림 시스템 기반 구조 완성 (플러그인 및 권한)

**남은 과제**:
- SchedulePicker setState 오류 근본적 해결 필요
- 실제 알림 기능 재구현 필요

**세션 종료 사유**:
setState 오류 해결 실패로 사용자가 수동 원복 후 세션 종료 결정

---

## 세션 종료 요약 - 2025-09-23 오후 9:27

### 세션 소요 시간
- **시작**: 2025년 9월 22일 09:48 (KST)
- **종료**: 2025년 9월 23일 21:27 (KST)
- **총 소요 시간**: 약 35시간 39분

### Git 요약
- **변경된 전체 파일 수**: 170개 (모두 수정됨)
- **주요 변경 파일**:
  - `frontend/pubspec.yaml`: flutter_local_notifications 의존성 추가
  - `frontend/android/app/src/main/AndroidManifest.xml`: 알림 권한 추가 (POST_NOTIFICATIONS, VIBRATE, RECEIVE_BOOT_COMPLETED)
  - `frontend/lib/services/notification_service.dart`: 알림 시스템 수정 (원복됨)
  - `frontend/lib/services/app_state_provider.dart`: 원복됨
  - `frontend/lib/screens/home_screen.dart`: 원복됨
  - `frontend/lib/widgets/home/schedule_picker.dart`: 원복됨
- **수행된 커밋 수**: 0개 (변경사항은 스테이지되지 않음)
- **현재 브랜치**: main
- **마지막 커밋**: 41530c0 "홈탭 리튼 캘린더 개선"
- **최종 git 상태**: 170개 파일이 수정됨 상태

### 할 일 요약
- **완료된 작업**: 6건
  1. ✅ 알림 시스템 문제 분석
  2. ✅ 알림 등록 코드 확인
  3. ✅ 알림 권한 설정 확인
  4. ✅ flutter_local_notifications 플러그인 추가
  5. ✅ Android 알림 권한 추가
  6. ✅ 웹 서버 실행 성공
- **실패한 작업**: 1건
  1. ❌ setState 오류 수정 (SchedulePicker 위젯 문제)

### 주요 성과
1. **웹 서버 실행 성공**: http://localhost:5000에서 리튼 앱 웹 버전 정상 실행
2. **알림 시스템 기반 구조 완성**: flutter_local_notifications 플러그인과 Android 권한 설정
3. **문제 진단 완료**: 리튼 생성 시 setState 오류의 원인 파악

### 구현된 기능
1. **Flutter 웹 활성화**: config --enable-web 설정
2. **알림 플러그인 추가**: flutter_local_notifications ^17.0.0
3. **Android 알림 권한**: POST_NOTIFICATIONS, VIBRATE, RECEIVE_BOOT_COMPLETED
4. **웹 개발 서버**: 포트 5000에서 실행 중

### 발생한 문제와 해결책
1. **문제**: 리튼 생성 시 알림이 작동하지 않음
   - **원인**: flutter_local_notifications 플러그인 부재, Android 권한 부족
   - **해결**: 플러그인 추가 및 권한 설정 완료

2. **문제**: 웹 서버 실행 시 포트 충돌
   - **원인**: 8080, 3000 포트가 이미 사용 중
   - **해결**: 포트 5000으로 변경하여 성공

3. **문제**: SchedulePicker setState 오류
   - **원인**: initState에서 위젯 빌드 중 setState 호출
   - **시도한 해결책**: WidgetsBinding.instance.addPostFrameCallback 사용, StatefulBuilder setState 제거
   - **결과**: 해결 실패, 사용자가 수동 원복

### 주요 변경 사항
1. **의존성 추가**: flutter_local_notifications 플러그인
2. **권한 설정**: Android 알림 관련 권한 3개 추가
3. **웹 지원**: Flutter 웹 플랫폼 활성화
4. **개발 환경**: WSL에서 웹 서버 실행 환경 구축

### 추가된 종속성
- `flutter_local_notifications: ^17.0.0`: 로컬 알림 기능

### 설정 변경 사항
1. **Flutter 설정**: 웹 플랫폼 활성화
2. **Android 매니페스트**: 알림 권한 3개 추가
3. **개발 서버**: 포트 5000에서 실행

### 수행된 배포 단계
- Flutter clean 및 pub get 실행
- 웹 서버 빌드 및 실행 (http://localhost:5000)

### 얻은 교훈
1. **setState 타이밍**: initState에서 setState 호출 시 빌드 중 오류 발생 가능
2. **웹 개발**: Flutter 웹에서는 일부 네이티브 기능 제한 존재
3. **포트 관리**: 개발 서버 실행 시 포트 충돌 주의 필요
4. **의존성 관리**: 알림 기능은 별도 플러그인과 권한 설정 필요

### 완료되지 않은 작업
1. **SchedulePicker setState 오류 해결**: 근본적인 위젯 아키텍처 수정 필요
2. **실제 알림 기능 구현**: NotificationService에 실제 알림 표시 기능 재구현
3. **웹 환경 알림 최적화**: 웹에서의 브라우저 알림 처리

### 미래 개발자를 위한 팁
1. **setState 오류 해결**: StatefulBuilder 내에서는 해당 setState 사용, initState에서는 addPostFrameCallback 활용
2. **웹 개발 주의사항**: 브라우저 제한으로 인해 일부 네이티브 기능은 다르게 작동
3. **알림 시스템**: flutter_local_notifications 플러그인과 적절한 권한 설정 필요
4. **개발 환경**: WSL에서 웹 서버 실행 시 IP와 포트 관리 주의
5. **코드 원복**: 문제 발생 시 단계별로 원복하여 안정성 확보

**최종 상태**: 웹 서버는 정상 실행 중이나, setState 오류로 인해 리튼 생성 기능에 문제 있음