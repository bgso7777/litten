# MariaDB 데이터베이스 설정 세션

**시작 시간**: 2025-10-09 08:15 (한국 시간)

## 개요 (Overview)

MariaDB 서버 설정 및 Litten 프로젝트용 데이터베이스 환경 구축 세션입니다.

## 목표 (Goals)

- [x] MariaDB 서버 정상 작동 확인
- [x] Litten 데이터베이스 생성 및 설정
- [x] 데이터베이스 사용자 계정 생성 및 권한 설정
- [x] Spring Boot 백엔드 연동 준비
- [x] Java 17 개발 환경 구성
- [x] Spring Boot 애플리케이션 실행 성공

## 진행 상황 (Progress)

### 08:07 - MariaDB 서비스 문제 해결
- 기존 MariaDB 서비스가 시작되지 않는 문제 발견
- `/opt/homebrew/etc/my.cnf`에서 `mysqlx-bind-address` 설정 제거 (MariaDB 비호환 설정)
- 손상된 데이터 디렉토리 백업 후 새로 초기화
- MariaDB 12.0.2 정상 실행 확인

### 08:08 - Litten 데이터베이스 설정 완료
- `litten` 데이터베이스 생성 (UTF8MB4, unicode collation)
- `litten@localhost` 사용자 생성 (비밀번호: litten1234)
- litten 데이터베이스에 대한 전체 권한 부여
- 접속 테스트 성공

### 08:30 - Maven 및 Java 개발 환경 설정
- Maven 3.9.11 설치 (Homebrew)
- Spring Boot 프로젝트에서 Lombok 컴파일 에러 발견
- Java 버전 호환성 문제 확인 (기존 Java 25 → Java 17 필요)

### 08:40 - Java 17 환경 구성 완료
- OpenJDK 17 설치
- `backend/pom.xml` 업데이트:
  - Java 버전 11 → 17로 변경
  - maven-compiler-plugin 추가 (Lombok annotation processor 설정)
- `.vscode/settings.json` 업데이트:
  - Java 17 경로 설정
  - Maven 실행 경로 설정

### 08:45 - Spring Boot 실행 설정 완료
- `.vscode/launch.json` 생성:
  - Spring Boot 실행 구성 추가
  - local 프로파일 활성화 (`-Dspring.profiles.active=local`)
  - 환경 변수 파일 설정
- `application.yml` 생성 (기본 프로파일 설정)

### 08:50 - Spring Boot 애플리케이션 실행 성공
- StartAccountManagerApplication 실행 확인
- Tomcat 서버 port 8989에서 정상 구동
- MariaDB 연결 성공 (jdbc:mariadb://localhost:3306/litten)

**변경된 파일**:
- `.vscode/settings.json`: Java 17 및 Maven 설정 추가
- `.vscode/launch.json`: Spring Boot 실행 구성 생성
- `backend/pom.xml`: Java 17 설정 및 Lombok 컴파일러 플러그인 추가
- `backend/src/main/resources/application.yml`: 프로파일 설정 추가

**해결된 문제**:
- MariaDB 서버 시작 실패 → 설정 파일 수정 및 데이터 재초기화로 해결
- Lombok 컴파일 에러 → Maven compiler plugin 설정으로 해결
- Java 버전 호환성 → Java 17 설치 및 설정으로 해결
- Spring 프로파일 미지정 → launch.json에 vmArgs 추가로 해결

## 다음 단계

- ✅ Spring Boot application-local.yml 설정 완료
- VSCode Run Java 버튼 동작 이슈 조사 (현재는 터미널에서 실행 가능)
- 데이터베이스 스키마 설계
- JPA Entity 클래스 작성

---

## 세션 종료 요약

**종료 시간**: 2025-10-09 08:52 (한국 시간)
**총 소요 시간**: 약 37분

### Git 변경 사항 요약

**변경된 파일 총 개수**: 6개
- 수정된 파일: 4개
- 추가된 파일: 2개
- 삭제된 파일: 0개

**변경된 파일 목록**:
1. `.claude/sessions/.current-session` - 수정 (세션 파일명 기록)
2. `.claude/sessions/2025-10-09-0815.md` - 추가 (세션 문서)
3. `.vscode/settings.json` - 수정 (Java 17 및 Maven 설정 추가)
4. `.vscode/launch.json` - 추가 (Spring Boot 실행 구성)
5. `backend/pom.xml` - 수정 (Java 17 및 Lombok 컴파일러 플러그인)
6. `0_history.txt` - 수정 (작업 히스토리 기록)

**Git 통계**:
- 추가된 줄: 54줄
- 삭제된 줄: 17줄
- 커밋 수: 0 (변경사항 스테이징되지 않음)

**최종 Git 상태**:
```
M .claude/sessions/.current-session
M .vscode/settings.json
M 0_history.txt
M backend/pom.xml
?? .claude/sessions/2025-10-09-0815.md
?? .vscode/launch.json
```

### 완료된 작업 (6/6)

1. ✅ MariaDB 서버 문제 진단 및 복구
2. ✅ Litten 데이터베이스 및 사용자 계정 생성
3. ✅ Maven 3.9.11 설치
4. ✅ Java 17 개발 환경 구성
5. ✅ Spring Boot 프로젝트 빌드 설정 (Lombok 지원)
6. ✅ Spring Boot 애플리케이션 실행 성공

### 주요 성과

1. **데이터베이스 인프라 구축 완료**
   - MariaDB 12.0.2 서버 정상화
   - litten 데이터베이스 생성 (UTF8MB4 인코딩)
   - litten 사용자 계정 생성 및 권한 부여

2. **Java 개발 환경 완전 구성**
   - OpenJDK 17 설치 및 설정
   - Maven 빌드 시스템 구축
   - Lombok 어노테이션 프로세서 통합

3. **Spring Boot 실행 환경 구축**
   - VSCode Java 개발 환경 설정
   - Spring Boot local 프로파일 구성
   - 애플리케이션 정상 구동 확인 (port 8989)

### 구현된 기능

1. **MariaDB 데이터베이스 설정**
   - 데이터베이스: `litten` (UTF8MB4)
   - 사용자: `litten@localhost`
   - 비밀번호: `litten1234`
   - 권한: 전체 권한 부여

2. **Spring Boot 프로파일 설정**
   - `application.yml`: 기본 프로파일 설정
   - `application-local.yml`: 로컬 개발 환경 설정
   - MariaDB JDBC 연결 설정

3. **VSCode 개발 환경**
   - Java 17 경로 설정
   - Maven 실행 경로 설정
   - Spring Boot 디버그 구성
   - local 프로파일 자동 활성화

### 발생한 문제와 해결책

| 문제 | 원인 | 해결책 |
|------|------|--------|
| MariaDB 서버 시작 실패 | `mysqlx-bind-address` 설정 오류 및 데이터 디렉토리 손상 | my.cnf 수정 및 데이터 디렉토리 재초기화 |
| Lombok 컴파일 에러 | Maven에서 Lombok annotation processor 미설정 | maven-compiler-plugin에 annotationProcessorPaths 추가 |
| Java 버전 호환성 문제 | Java 25 사용 중, Spring Boot 2.6.0은 Java 17 필요 | OpenJDK 17 설치 및 pom.xml 업데이트 |
| Spring 프로파일 미지정 | launch.json에 프로파일 설정 누락 | vmArgs에 `-Dspring.profiles.active=local` 추가 |
| VSCode Run Java 버튼 무반응 | Java Extension 또는 PATH 문제 | 터미널에서 직접 실행하는 방식으로 우회 |

### 주요 변경 사항

1. **backend/pom.xml**
   - Java 버전: 11 → 17
   - maven-compiler-plugin 추가 (Lombok 지원)

2. **.vscode/settings.json**
   - Java 17 홈 경로 지정
   - Spring Boot LS Java 홈 경로 지정
   - Maven 실행 파일 경로 지정

3. **.vscode/launch.json** (신규 생성)
   - StartAccountManagerApplication 실행 구성
   - local 프로파일 자동 활성화
   - 디버그 attach 구성 추가

### 추가된 종속성

없음 (기존 pom.xml의 종속성 그대로 사용)

### 설정 변경 사항

1. **MariaDB 설정** (`/opt/homebrew/etc/my.cnf`)
   - `mysqlx-bind-address` 제거
   - `bind-address = 127.0.0.1` 유지

2. **Java 환경 변수**
   - `JAVA_HOME`: `/opt/homebrew/opt/openjdk@17/libexec/openjdk.jdk/Contents/Home`
   - `PATH`: Java 17 bin 디렉토리 추가

3. **Maven 설정**
   - Java 17 컴파일러 사용
   - Lombok annotation processing 활성화

### 얻은 교훈

1. **MariaDB와 MySQL 설정 호환성 주의**
   - MySQL X Plugin 설정(`mysqlx-bind-address`)은 MariaDB에서 지원하지 않음
   - 설정 파일 검증 필요

2. **Lombok 사용 시 Maven 설정 필수**
   - annotation processor 경로를 명시적으로 설정해야 컴파일 가능
   - IDE와 빌드 도구 모두에서 Lombok 인식 필요

3. **Java 버전 관리의 중요성**
   - Spring Boot 버전과 Java 버전 호환성 확인 필요
   - 너무 최신 Java 버전은 오히려 문제 발생 가능

4. **VSCode Java Extension 설정**
   - `java.jdt.ls.java.home`과 `spring-boot.ls.java.home` 모두 설정 필요
   - Run Java 버튼이 작동하지 않을 때 터미널 실행 대안 활용

### 미완료 작업

1. **VSCode Run Java 버튼 문제 해결**
   - 현재 상태: 터미널에서는 정상 실행되나 VSCode 버튼 무반응
   - 필요 조치: Java Extension 재설치 또는 설정 추가 검토

2. **데이터베이스 스키마 경고 해결**
   - 경고: "Invalid default value for 'fd_staff_id'"
   - 영향도: 낮음 (애플리케이션은 정상 동작)

3. **데이터베이스 스키마 설계**
   - 리튼 공간 관련 테이블 설계 필요
   - 듣기, 쓰기, 필기 파일 테이블 설계 필요

4. **JPA Entity 클래스 작성**
   - 데이터베이스 스키마에 매핑되는 Entity 클래스 작성

### 미래 개발자를 위한 팁

1. **Spring Boot 실행 방법**
   ```bash
   cd backend
   export JAVA_HOME=/opt/homebrew/opt/openjdk@17/libexec/openjdk.jdk/Contents/Home
   export PATH="$JAVA_HOME/bin:$PATH"
   mvn spring-boot:run
   ```

2. **데이터베이스 접속**
   ```bash
   mysql -u litten -p litten
   # 비밀번호: litten1234
   ```

3. **MariaDB 서비스 관리**
   ```bash
   brew services start mariadb    # 시작
   brew services stop mariadb     # 중지
   brew services restart mariadb  # 재시작
   ```

4. **Java 버전 확인**
   ```bash
   java -version  # 현재 사용 중인 Java 버전
   /usr/libexec/java_home -V  # 설치된 모든 Java 버전
   ```

5. **프로젝트 구조**
   - Frontend: `/Users/mymac/Desktop/litten/frontend` (Flutter)
   - Backend: `/Users/mymac/Desktop/litten/backend` (Spring Boot)
   - DB Config: `backend/src/main/resources/application-local.yml`

6. **개발 시 주의사항**
   - Spring Boot 실행 전 MariaDB 서비스 확인
   - local 프로파일로 실행해야 로컬 DB 연결
   - Lombok 사용 시 IDE에서도 Lombok plugin 설치 필요

---

**세션 상태**: 종료됨
**다음 세션 추천 작업**: 데이터베이스 스키마 설계 및 JPA Entity 클래스 작성
